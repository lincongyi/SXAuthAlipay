(self["webpackChunklive_demo"]=self["webpackChunklive_demo"]||[]).push([[853],{8005:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return K}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("div",{staticClass:"wrap-top"},[e("van-nav-bar",{attrs:{border:!1,"left-arrow":""},on:{"click-left":t.onClickLeft}}),1===t.recordStatus||3===t.recordStatus?e("div",{staticClass:"tip-title"},[t._v("ËØ∑Èù¢ÂêëÂ±èÂπïÂºÄÂßãÂΩïÂà∂ËßÜÈ¢ë")]):t._e(),2===t.recordStatus?e("div",{staticClass:"tip-title"},[t._v("ËØ∑Èù¢ÂêëÂ±èÂπï "+t._s(t.titles))]):t._e(),4===t.recordStatus?e("div",{staticClass:"tip-title"},[t._v("Ê≠£Âú®Ê£ÄÊµã‰∏≠...")]):t._e(),e("cw-video",{ref:"cwVideoRef",attrs:{showDefaultImg:!t.isOpenVideo,loading:t.loading},scopedSlots:t._u([{key:"imgSlot",fn:function(){return[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpenVideo,expression:"isOpenVideo"}],staticClass:"video-wrap",attrs:{id:"video-box"}},[e("video",{attrs:{id:"videoPlay",playinline:"",autoplay:""}})])]},proxy:!0}])})],1),e("div",{staticClass:"wrap-bottom"},[t.isShowInfo?e("TipInfo"):t._e(),t.isShowBtn?e("div",{staticClass:"op-btn"},[e("CwButton",{attrs:{loading:t.btnLoading},on:{click:t.openCamera}},[t._v("ÂºÄÂßãÂΩïÂà∂ËßÜÈ¢ë")])],1):t._e()],1),e("CwNativeCameraPopup",{attrs:{titles:t.titles},on:{nativeRecord:t.nativeRecord,cancelClick:t.nativeCancelClick},model:{value:t.showNativeCamera,callback:function(e){t.showNativeCamera=e},expression:"showNativeCamera"}}),e("CwRsultPopup",{on:{reRecord:t.reRecord,cancelClick:t.cancelClick},model:{value:t.showResult,callback:function(e){t.showResult=e},expression:"showResult"}})],1)},o=[];i(7941),i(2526),i(7327),i(1539),i(5003),i(9554),i(4747),i(9337),i(3321),i(9070);function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function l(t){if(Array.isArray(t))return c(t)}i(1817),i(2165),i(8783),i(3948),i(1038);function u(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}i(7042),i(4916),i(7601);function p(t,e){if(t){if("string"===typeof t)return c(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(t,e):void 0}}i(1703),i(6647);function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t){return l(t)||u(t)||p(t)||d()}i(1249),i(9600),i(8862);var v=function(){var t=this,e=t._self._c;return e("van-button",t._g(t._b({staticClass:"cw-button",attrs:{type:"primary",size:"large",color:"linear-gradient(135deg, #4C60BF 0%, #4C60BF 100%)",block:""}},"van-button",t.$attrs,!1),t.$listeners),[t._t("default")],2)},h=[],w={},m=w,C=i(1001),g=(0,C.Z)(m,v,h,!1,null,"a314852e",null),b=g.exports,y=i(338),_=function(){var t=this,e=t._self._c;return e("van-popup",t._g(t._b({staticClass:"cw-popup",attrs:{position:"bottom",round:"","close-on-click-overlay":!1}},"van-popup",t.$attrs,!1),t.$listeners),[e("div",{staticClass:"popup-content"},[e("div",{staticClass:"popup-title"},[t._v("ËØ∑‰∏ä‰º†ËßÜÈ¢ë")]),e("div",{staticClass:"popup-text"},[t._v("ËØ∑Èù¢ÂêëÂ±èÂπïÂÅö‰ª•‰∏ãÂä®‰Ωú:"+t._s(t.titles))]),e("div",{staticClass:"start-btn"},[e("CwButton",{on:{click:t.nativeRecord}},[t._v("ÂºÄÂßãÂΩïÂà∂")])],1),e("div",{staticClass:"cancel-btn",on:{click:function(e){return t.$emit("cancelClick")}}},[t._v("ÈÄÄÂá∫")])])])},S=[],k={props:{titles:{type:String,default:""}},components:{CwButton:b},methods:{nativeRecord:function(){this.$emit("nativeRecord")}}},R=k,O=(0,C.Z)(R,_,S,!1,null,"f9713bf6",null),x=O.exports,A=function(){var t=this,e=t._self._c;return e("van-popup",t._g(t._b({staticClass:"cw-popup",attrs:{position:"bottom",round:"","close-on-click-overlay":!1}},"van-popup",t.$attrs,!1),t.$listeners),[e("div",{staticClass:"popup-content"},[e("div",{staticClass:"popup-title"},[t._v("È™åËØÅÂ§±Ë¥•")]),e("div",{staticClass:"popup-text"},[t._v("ËØ∑ÈÅøÂÖç‰∏Ä‰∏ãÈóÆÈ¢òÔºö")]),e("div",{staticClass:"popup-text"},[t._v("ÂøòËÆ∞Áú®Áúº„ÄÅÈÅÆÊå°‰∫∫ËÑ∏„ÄÅÂÖ≥ÁÖß‰∏çÂùá„ÄÅÊâãÊú∫ÊëáÊôÉ")]),e("div",{staticClass:"popup-text"},[t._v(" Â¶ÇÊúâÁñëÈóÆÔºåËØ∑ËÅîÁ≥ªÂÆ¢Êúç "),e("span",{staticClass:"text-tel"},[t._v(t._s(t.telphone))])]),e("div",{staticClass:"start-btn"},[e("CwButton",{on:{click:t.reRecord}},[t._v("ÈáçÊñ∞ÂΩïÂà∂")])],1),e("div",{staticClass:"cancel-btn",on:{click:function(e){return t.$emit("cancelClick")}}},[t._v("ÈÄÄÂá∫")])])])},j=[],P={components:{CwButton:b},data:function(){return{telphone:""}},mounted:function(){this.telphone=window.config.errorTelphone},methods:{reRecord:function(){this.$emit("reRecord")}}},I=P,B=(0,C.Z)(I,A,j,!1,null,"3fb88528",null),N=B.exports,$=i(6265),F=i.n($),V=function(){var t=this,e=t._self._c;return e("div",{staticClass:"static-tip-warp"},t._l(t.staticTip,(function(i){return e("div",{key:i.text,staticClass:"static-tip"},[e("div",{staticClass:"img"},[e("img",{attrs:{src:i.img}})]),e("div",{staticClass:"text"},[t._v(" "+t._s(i.text)+" ")])])})),0)},T=[],U=i.p+"static/img/tip-screen.80e38ae3.png",E=i.p+"static/img/tip-outline.02999415.png",L=i.p+"static/img/tip-light.52df7583.png",M={data:function(){return{staticTip:[{img:U,text:"Ê≠£ÂØπÂ±èÂπï"},{img:E,text:"ËΩÆÂªìÊ∏ÖÊô∞"},{img:L,text:"‰∫ÆÂ∫¶ÂùáÂåÄ"}]}}},D=M,Z=(0,C.Z)(D,V,T,!1,null,"2eb850c1",null),W=Z.exports,z=window.config.uploadUrl,J=window.config.actionNum||2,q={components:{CwButton:b,CwVideo:y.Z,CwNativeCameraPopup:x,CwRsultPopup:N,TipInfo:W},data:function(){return{showNativeCamera:!1,showResult:!1,videoInstance:null,isSupport:!0,btnLoading:!1,recordStatus:1,activeActions:[],isUploadFinish:!1,actionsArr:[{title:"Áú®Áú®Áúº",action:"1"},{title:"Âº†Âº†Âò¥",action:"2"},{title:"ÊëáÊëáÂ§¥",action:"5"}]}},computed:{isOpenVideo:function(){return this.isSupport&&2===this.recordStatus},isShowInfo:function(){return 1===this.recordStatus||3===this.recordStatus},isShowBtn:function(){return 1===this.recordStatus||3===this.recordStatus},loading:function(){return 4===this.recordStatus&&!this.isUploadFinish},titles:function(){var t=this.activeActions.map((function(t){return t.title}));return t.join("„ÄÅ")},actions:function(){var t=this.activeActions.map((function(t){return t.action}));return t.join(",")}},mounted:function(){this.initFs(),this.initVideo()},methods:{initFs:function(){if(1===J){var t=Math.floor(Math.random()*(this.actionsArr.length-1)+1);this.activeActions=this.actionsArr.filter((function(e,i){return i===t-1}))}else if(2===J){var e=Math.floor(Math.random()*(this.actionsArr.length-1)+1);this.activeActions=this.actionsArr.filter((function(t,i){return i!==e-1}))}else this.activeActions=f(this.actionsArr)},openCamera:function(){var t=this;t.isSupport?(t.btnLoading=!0,t.videoInstance.openCamera({onError:function(){console.warn("‰∏çÊîØÊåÅ"),t.showNativeCamera=!0,t.isSupport=!1,t.recordStatus=3,t.btnLoading=!1},onSuccess:function(){console.warn("ÊîØÊåÅ"),t.recordStatus=2,t.startCollect(),t.btnLoading=!1}})):t.showNativeCamera=!0},startCollect:function(){var t=(window.config.recordTime||5e3)/1e3,e=!0,i=this;i.videoInstance.startCollect({time:t,timeCallback:function(n){e&&(e=!1,i.$refs.cwVideoRef.start(t)),console.warn(n),n<=0&&(i.recordStatus=4)}})},initVideo:function(){this.recordStatus=1;var t=this;this.videoInstance=new CWMediaCollector({webmWasmPath:"./static/webm-wasm.wasm",webmWorkerPath:"./static/webm-worker.js",el:document.getElementById("video-box"),height:480,width:480,autoOpenNativeCamera:!1,mode:1,maxFileSize:10,frameRate:10,isFrontCamera:!0,mimeType:"video/webm;codecs=h264",onInitSuccess:function(e){20002===e.code?t.isSupport=!1:t.isSupport=!0},onSuccess:function(e){console.log("recordingEnd==",e),2e4===e.code?(console.log("ÂΩïÂà∂ÁªìÊùü‰∫Ü‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî"),e.data?(t.postBlob(e.data),console.warn("ÂΩïÂèñÁöÑÊï∞ÊçÆ",e.data),t.recordStatus=4,t.showNativeCamera=!1):(console.warn("ÂΩïÂà∂ÁöÑÊï∞ÊçÆ‰∏∫0"),t.showResult=!0)):t.showResult=!0},onError:function(e){console.log("üöÄ ~ html ~ initVideo ~ res",e,e.code,"--",e.message),console.log(e.message),t.showResult=!0}})},setResult:function(t){localStorage.setItem("result",JSON.stringify(t))},postBlob:function(t){var e=this;CWMediaCollector.blobToBase64(t,(function(t){console.warn("ÂΩïÂà∂ÁöÑÊñá‰ª∂",t),console.warn("Êñá‰ª∂Â§ßÂ∞èByte",t.length),e.checkFace(t,(function(i){i.isAlive&&i.image?(e.setResult({result:!0,size:t.length,image:"data:image/jpeg;base64,"+i.image,res:i}),e.$router.push({path:"/result"})):(i.isAlive||0!==i.result)&&(i.isAlive||0===i.result)||(e.showResult=!0)}))}))},checkFace:function(t,e){var i=this,n=a(a({},window.config.uploadParameter||{}),{},{video:t,action:this.actions});this.isUploadFinish=!1,F().post(z,n).then((function(t){200===t.status?e(t.data):console.warn("Â§±Ë¥•status !== 200:",t.status)})).catch((function(t){console.warn("ËØ∑Ê±ÇÂá∫Èîô:",t)})).finally((function(){i.isUploadFinish=!0}))},reRecord:function(){console.warn("ÈáçÊñ∞ÂΩïÂà∂ÂäüËÉΩ"),this.showResult=!1,this.$refs.cwVideoRef.init(),this.initFs(),this.initVideo()},nativeRecord:function(){this.videoInstance&&this.videoInstance.openNativeCamera()},onClickLeft:function(){console.warn("ÁÇπÂáª‰∫ÜËøîÂõûÈîÆÁõò");var t=window.config.returnUrl;location.href=t},cancelClick:function(){console.warn("ÁÇπÂáª‰∫ÜÂ§±Ë¥•ÁöÑÈÄÄÂá∫ÂäüËÉΩ");var t=window.config.failedUrl;location.href=t},nativeCancelClick:function(){var t=window.config.returnUrl;location.href=t}}},G=q,H=(0,C.Z)(G,n,o,!1,null,"cd160e16",null),K=H.exports},8457:function(t,e,i){"use strict";var n=i(9974),o=i(6916),r=i(7908),s=i(3411),a=i(7659),c=i(4411),l=i(6244),u=i(6135),p=i(8554),d=i(1246),f=Array;t.exports=function(t){var e=r(t),i=c(this),v=arguments.length,h=v>1?arguments[1]:void 0,w=void 0!==h;w&&(h=n(h,v>2?arguments[2]:void 0));var m,C,g,b,y,_,S=d(e),k=0;if(!S||this===f&&a(S))for(m=l(e),C=i?new this(m):f(m);m>k;k++)_=w?h(e[k],k):e[k],u(C,k,_);else for(b=p(e,S),y=b.next,C=i?new this:[];!(g=o(y,b)).done;k++)_=w?s(b,h,[g.value,k],!0):g.value,u(C,k,_);return C.length=k,C}},3411:function(t,e,i){var n=i(9670),o=i(9212);t.exports=function(t,e,i,r){try{return r?e(n(i)[0],i[1]):e(i)}catch(s){o(t,"throw",s)}}},1038:function(t,e,i){var n=i(2109),o=i(8457),r=i(7072),s=!r((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:s},{from:o})},9337:function(t,e,i){var n=i(2109),o=i(9781),r=i(3887),s=i(5656),a=i(1236),c=i(6135);n({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(t){var e,i,n=s(t),o=a.f,l=r(n),u={},p=0;while(l.length>p)i=o(n,e=l[p++]),void 0!==i&&c(u,e,i);return u}})}}]);
//# sourceMappingURL=853-legacy.cf9d8dfd.js.map